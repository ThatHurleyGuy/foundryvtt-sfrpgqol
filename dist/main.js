!function(t){var e={};function a(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=e,a.d=function(t,e,o){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(o,n,function(e){return t[e]}.bind(null,n));return o},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=0)}([function(t,e,a){"use strict";function o(...t){console.log("SFRPG Qol | ",...t)}a.r(e),a.d(e,"doRoll",(function(){return l}));class n{constructor(t,e,a,o){this.actionName=t,this.message=e,this.intendedFor=a,this.data=o}}class r{constructor(t){this.callback=t,this.socket=game.socket,this.socket.on("module.sfrpgqol",e=>{o("Processing socket message"),t(e)})}broadcastData(t){game.user.id!==t.intendedFor?this.socket.emit("module.sfrpgqol",t):this.callback(t)}}const s=async t=>{switch(t.actionName){case"action_name":if(!game.user.isGM)break;await(async t=>{o("Handling damage"),o(t.data.targetId);const e=canvas.tokens.get(t.data.targetId);await e.actor.update({"data.attributes.hp.value":e.actor.data.data.attributes.hp.value-t.data.totalDamage})})(t)}};let i;Hooks.once("init",async()=>{o("Initializing sfrpg-qol"),window.SFRPGQOL={doRoll:l}}),Hooks.once("ready",async()=>{i=new r(s)});const c=1;async function l(t,e){const a=ChatMessage.getSpeaker(),r=canvas.tokens.get(a.token),s=r?r.actor:game.actors.get(a.actor);game.user.targets.forEach(async a=>{const r=game.users.entities.find(t=>t.isGM&&t.active);o("Target",a);const l={targetId:a.data._id,totalDamage:9},d=new n("action_name",r.id,"foobarbazmessage",l);i.broadcastData(d);const u=a.actor,g=s.items.find(t=>t.name===e),m=u.data.data.attributes;await g.rollAttack({event:t});const f={targetAttributes:m,damageAppliedString:"Nailed it."},p=await renderTemplate("modules/sfrpgqol/public/templates/hits.html",f),b={user:game.user._id,speaker:{actor:u,alias:null==u?void 0:u.name},content:p,type:CONST.CHAT_MESSAGE_TYPES.OTHER,flags:{sfrpgQolType:c}};ChatMessage.create(b)})}Hooks.on("hotbarDrop",(t,e,a)=>(o("Handling hotbarDrop"),(async(t,e)=>{const a=`SFRPGQOL.doRoll(event, "${t.name}")`,o=await Macro.create({name:`${t.name} - ${t.type}`,type:"script",img:t.img,command:a,flags:{"sfrpgqol.itemMacro":!0}});await game.user.assignHotbarMacro(o,e)})(e.data,a),!1))}]);